$(document).ready((function(){$("[data-bs-chart]").each((function(e,t){this.chart=new Chart($(t),$(t).data("bs-chart"))}))})),function(e){"use strict";var t=0;function n(e){for(var n in this.props={title:"",body:"",footer:"",modalClass:"fade",modalDialogClass:"",options:null,onCreate:null,onDispose:null,onSubmit:null},e)this.props[n]=e[n];this.id="bootstrap-show-modal-"+t,t++,this.show()}n.prototype.createContainerElement=function(){var t=this;this.element=document.createElement("div"),this.element.id=this.id,this.element.setAttribute("class","modal "+this.props.modalClass),this.element.setAttribute("tabindex","-1"),this.element.setAttribute("role","dialog"),this.element.setAttribute("aria-labelledby",this.id),this.element.innerHTML='<div class="modal-dialog '+this.props.modalDialogClass+'" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"></h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"></div><div class="modal-footer"></div></div></div>',document.body.appendChild(this.element),this.titleElement=this.element.querySelector(".modal-title"),this.bodyElement=this.element.querySelector(".modal-body"),this.footerElement=this.element.querySelector(".modal-footer"),e(this.element).on("hidden.bs.modal",(function(){t.dispose()})),this.props.onCreate&&this.props.onCreate(this)},n.prototype.show=function(){this.element?e(this.element).modal("show"):(this.createContainerElement(),this.props.options?e(this.element).modal(this.props.options):e(this.element).modal()),this.props.title?(e(this.titleElement).show(),this.titleElement.innerHTML=this.props.title):e(this.titleElement).hide(),this.props.body?(e(this.bodyElement).show(),this.bodyElement.innerHTML=this.props.body):e(this.bodyElement).hide(),this.props.footer?(e(this.footerElement).show(),this.footerElement.innerHTML=this.props.footer):e(this.footerElement).hide()},n.prototype.hide=function(){e(this.element).modal("hide")},n.prototype.dispose=function(){e(this.element).modal("dispose"),document.body.removeChild(this.element),this.props.onDispose&&this.props.onDispose(this)},e.extend({showModal:function(e){if(e.buttons){var t="";for(var o in e.buttons){t+='<button type="button" class="btn btn-primary" data-value="'+o+'" data-dismiss="modal">'+e.buttons[o]+"</button>"}e.footer=t}return new n(e)},showAlert:function(e){return e.buttons={OK:"OK"},this.showModal(e)},showConfirm:function(t){return t.footer='<button class="btn btn-secondary btn-false btn-cancel">'+t.textFalse+'</button><button class="btn btn-primary btn-true">'+t.textTrue+"</button>",t.onCreate=function(t){e(t.element).on("click",".btn",(function(e){e.preventDefault(),t.hide(),t.props.onSubmit(-1!==e.target.getAttribute("class").indexOf("btn-true"),t)}))},this.showModal(t)}})}(jQuery);var testTool={b64EncodeUnicode:function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))},b64DecodeUnicode:function(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},isMobileDevice:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)},getMeetingConfig:function(){return{mn:parseInt(document.getElementById("meeting_number").value),name:testTool.b64EncodeUnicode(document.getElementById("display_name").value),pwd:document.getElementById("meeting_pwd").value,role:parseInt(document.getElementById("meeting_role").value,10),email:testTool.b64EncodeUnicode(document.getElementById("meeting_email").value),lang:document.getElementById("meeting_lang").value,signature:"",china:document.getElementById("meeting_china").value}},createZoomNode:function(e,t){const n=document.createElement("iframe");n.id=e,n.sandbox="allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox",n.allow="microphone; camera; fullscreen;",n.src=t,n.style="","function"==typeof document.body.append?document.body.append(n):document.body.appendChild(n)},getCurrentDomain:function(){return window.location.protocol+"//"+window.location.hostname+":"+window.location.port},parseQuery:function(){return function(){for(var e=window.location.href,t=e.substr(e.indexOf("?")),n={},o=("?"===t[0]?t.substr(1):t).split("&"),a=0;a<o.length;a+=1){var i=o[a].split("=");n[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||"")}return n}()},parseURL:function(e){return function(){var t=e,n=new URL(e),o=t.substr(t.indexOf("?")),a={};a.url=e,a.hostname=n.hostname,a.pathname=n.pathname,a.hash=n.hash;for(var i=("?"===o[0]?o.substr(1):o).split("&"),r=0;r<i.length;r+=1){var s=i[r].split("=");a[decodeURIComponent(s[0])]=decodeURIComponent(s[1]||"")}return a}()},serialize:function(e){var t=["name","mn","email","pwd","role","lang","signature","china"];Array.intersect=function(){for(var e=new Array,t={},n=0;n<arguments.length;n++)for(var o=0;o<arguments[n].length;o++){var a=arguments[n][o];t[a]?(t[a]++,t[a]==arguments.length&&e.push(a)):t[a]=1}return e},Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,value:function(e){return this.filter((function(t){return t===e})).length>0}});var n=Array.intersect(t,Object.keys(e)),o=[];return t.forEach((function(t){n.includes(t)&&o.push([t,e[t]])})),Object.keys(e).sort().forEach((function(t){n.includes(t)||o.push([t,e[t]])})),function(e){var t=[];for(var n in e)void 0!==e[n][1]&&t.push(encodeURIComponent(e[n][0])+"="+encodeURIComponent(e[n][1]));return t.join("&")}(o)},detectOS:function(){var e=navigator.userAgent,t="Win32"===navigator.platform||"Windows"===navigator.platform,n="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(n)return"Mac";if("X11"===navigator.platform&&!t&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Win2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"WinXP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Win2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"WinVista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Win7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Win10"}return"other"},detectIE:function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return"IE"+parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return"IE"+parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var o=e.indexOf("Edge/");return o>0&&"Edge"+parseInt(e.substring(o+5,e.indexOf(".",o)),10)},getBrowserInfo:function(){var e=navigator.userAgent.toLowerCase();if(e.indexOf("firefox")>0)return e.match(/firefox\/[\d.]+/gi);if(e.indexOf("safari")>0&&e.indexOf("chrome")<0){var t,n="safari/unknow";return n=e.match(/version\/[\d.]+/gi),t=e.match(/safari\/[\d.]+/gi),n&&(n=n.toString().replace("version","safari")),t&&(n=t.toString().replace("version","safari")),n}var o=testTool.detectIE();return o||(e.indexOf("chrome")>0?e.match(/chrome\/[\d.]+/gi):"other")},getRandomInt:function(e){return Math.floor(Math.random()*Math.floor(e))},extractHostname:function(e){return(e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]},getDomainName:function(e){return e.substring(e.lastIndexOf(".",e.lastIndexOf(".")-1)+1)},setCookie:function(e,t){var n=new Date;n.setTime(n.getTime()+864e5);var o="expires="+n.toUTCString();document.cookie=e+"="+t+";"+o+";path=/"},getCookie:function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o+=1){for(var a=n[o];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""},deleteAllCookies:function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var n=e[t],o=n.indexOf("="),a=o>-1?n.substr(0,o):n;document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}};window.testTool=testTool,sessionStorage.clear();const signinPage="signin.html",signupPage="signup.html";window._config={cognito:{userPoolId:"us-east-1_InedFezwr",region:"us-east-1",clientId:"2g2q4svd2pg3lro7jv9ae5q59h"}};const CORS="",ENDPOINT="https://api.ahmedalnajjar.com/dev";let poolData={UserPoolId:_config.cognito.userPoolId,ClientId:_config.cognito.clientId},parsedURL=testTool.parseURL(window.location.href);if(null!=document.querySelector("iframe")){function resizeIframe(){this.style.height=this.contentWindow.document.body.offsetHeight+"px",this.scrolling="no"}document.querySelector("iframe").addEventListener("load",resizeIframe)}$(".password-toggle").on("click",(function(e){"password"===$(this).parent().parent().find("input").attr("type")?($(this).parent().parent().find("input").attr("type","text"),$(this).find("i").removeClass("fa fa-eye").addClass("fa fa-eye-slash")):($(this).parent().parent().find("input").attr("type","password"),$(this).find("i").removeClass("fa fa-eye-slash").addClass("fa fa-eye"))}));let datePickerOpts={language:"en",dateFormat:"yyyy-mm-dd"},dateTimePickerOpts={language:"en",dateFormat:"yyyy-mm-dd",timepicker:!0,timeFormat:"hh:mm aa"};function successToast(e){$.toast({icon:"success",text:`<p class='p-3'>${e}</p>`,delay:"3000",position:"bottom-center",dismissible:!1})}function warningToast(e){$.toast({icon:"warning",text:`<p class='p-3'>${e}</p>`,delay:"3000",position:"top-right",dismissible:!1})}function dangerToast(e){$.toast({icon:"danger",text:`<p class='p-3'>${e}</p>`,delay:"3000",position:"bottom-center",dismissible:!1})}function payNow(e,t){$.ajax({url:`${ENDPOINT}/users/${sessionStorage.getItem("pid")}/payments`,method:"POST",contentType:"application/json",data:JSON.stringify({event_id:e,creator_email:t}),processing:!1}).done((function(e){console.log(e),200===e.statusCode?window.location.href=e.url:dangerToast("Unable to connect to server")})).fail((function(e){console.log(e),dangerToast("Unable to Connect to Server")}))}function fillCheckListNow(e){window.location.href="./checklist.html?checklist="+e}function pendingForm(e){window.location.href="./forms.html?form="+e}function submitForms(e){console.log(form2js("forms",".",!0));var t=form2js("forms",".",!0);null!=t.phone_number&&(t.phone_number="+"+$(".tel-phone-input").intlTelInput("getSelectedCountryData").dialCode+t.phone_number),t.email=sessionStorage.getItem("pt-email"),console.log("submit form data - ",t),asyncResponse("POST",`/users/${sessionStorage.getItem("pid")}/forms`,t,e=>{201==e.statusCode?successToast("Submitted Successfully"):dangerToast("Submition Failed")})}function confirmAppointment(e){$.showConfirm({title:"Appointment Confirmation",body:"Do you want to confirm this appointment",textTrue:"CONFIRM",textFalse:"CANCEL",onSubmit:function(e){e&&$.ajax({url:ENDPOINT+"/appointments",type:"PUT",dataType:"json",data:JSON.stringify({patient_id:pid,patient_email:pt_mail,creator_email:doc_mail,event_id:eid}),async:!1,contentType:"application/json"}).done((function(e){console.log(e),200==e.statusCode?successToast("Appointment Confirmed"):dangerToast("Confirmation Failed")})).fail((function(e){return console.log("error -",e),dangerToast("Confirmation Failed"),e}))}})}function showInvoice(e){getResponse(`/users/${sessionStorage.getItem("pid")}/invoice`,{filter_name:"sub",filter_value:e},null);var t=`<html><head>${bootstrapCDN}${style}</head><body>${renderInvoice()}</body></html>`;$.showModal({title:"INVOICE <button class='btn btn-sm btn-primary position-absolute print' style='right:50px;'>PRINT</button>",body:`<iframe id="printContent" name="printContent" height="500" srcdoc='${t}'></iframe>`});$("iframe#printContent").height();var n=$("iframe#printContent").parent().height(500);console.log(n)}if($(".datepicker-here").css("z-index",500),null!=testTool.isMobileDevice()&&($(".datepicker-here").attr("type","date").removeClass("datepicker-here"),$(".datetimepicker-here").attr("type","datetime-locale").removeClass("datetimepicker-here")),$(".datepicker-here").datepicker(datePickerOpts),$(".datetimepicker-here").datepicker(dateTimePickerOpts),$(document).on("click",".action, a",(function(e){var t=$(this).data("action"),n=$(this).data("id");if(console.log("button clicked data - ",t,n),"confirm"===t&&confirmAppointment($(this).data("eid"),$(this).data("pid"),$(this).data("ptMail"),$(this).data("docMail")),"pay-now"===t&&payNow($(this).data("eid"),$(this).data("docMail")),"reschedule"===t&&rescheduleAppointment(n),"pending-form"===t){pendingForm($(this).data("form"))}"forms"===t&&submitForms(this),"view-form"===t&&forms.viewForm($(this).data("formType"),$(this).data("created")),"checklist"===t&&fillCheckListNow($(this).data("form"))})),$("#form-reset").on("click",(function(){$("#patient-select").empty()})),$(".tel-phone-input").length&&$(".tel-phone-input").intlTelInput({autoPlaceholder:"off",preferredCountries:["ae"],utilsScript:"https://cdn.jsdelivr.net/npm/intl-tel-input@17.0.8/build/js/utils.js"}),$(".countries-list").length){$(".countries-list").select2({width:"100%"});var countryData=window.intlTelInputGlobals.getCountryData();addressDropdown=document.querySelector(".countries-list"),countryData.forEach(e=>{var t=document.createElement("option");t.value=e.name;var n=document.createTextNode(e.name);t.appendChild(n),addressDropdown.appendChild(t)}),$(".countries-list").val("")}function findAge(e){return moment().diff(e,"years",!1)}function getUserName(e){return`${null!=e.given_name?e.given_name+" ":""}\n  ${null!=e.middle_name?e.middle_name+" ":""}\n  ${null!=e.family_name?e.family_name+" ":""}`}function renderUserHtml(e){return`<div class="row m-1 py-3 small rounded shadow">\n                <div class="col-sm-auto text-center">\n                  <img class="w-100" style="max-width: 100px;" src=${null!=e.picture?e.picture:"./assets/img/user.svg"} />\n                </div>\n                <div class="col">\n                    <div class="row">\n                        <div class="col">\n                        <h6 class="text-capitalize mb-0 font-weight-bold">\n                        ${null!=e.given_name?e.given_name+" ":""}\n                        ${null!=e.middle_name?e.middle_name+" ":""}\n                        ${null!=e.family_name?e.family_name+" ":""}\n                        </h6>\n                            <p>${e.email}</p>\n                            ${null!=e.birthdate?`<p class="mb-0"><strong>DOB</strong>: ${e.birthdate}</p>`:""}\n                            ${null!=e.birthdate?`<p class="mb-0"><strong>Age</strong>: ${findAge(e.birthdate)} Years</p>`:""}\n                        </div>\n                        <div class="col">\n                        ${null!=e.locale?`<p class="mb-0"><strong>Nationality</strong>: ${e.locale}</p>`:""}\n                            ${null!=e.phone_number?`<p class="mb-0"><strong>Phone</strong>: ${e.phone_number}</p>`:""}\n                            ${null!=e.address?`<p class="mb-0"><strong>Address</strong>: ${e.address}</p>`:""}\n                            ${null!=e.preferred_username?`<p class="mb-0"><strong>Emirates ID</strong>: ${e.preferred_username}</p>`:""}\n                        </div>\n                    </div>\n                </div>\n            </div>`}function eventTimeToString(e,t){return`${moment(e).format("LL")} - ${moment(t).format("LT")}`}function serviceDetails(e){return`${null!=e.service_type?e.service_type+" | ":""} \n  ${null!=e.service_amount?""+e.service_amount:""}\n  ${null!=e.service_currency?e.service_currency+" | ":""}\n  ${null!=e.service_duration?e.service_duration+" min | ":""}\n  ${null!=e.service_desc?e.service_desc+" ":""}\n  `}function renderApptHtml(e){return htmlContent=`<div class="row m-1 my-3 py-3 small rounded shadow" >\n    <div class="col">\n        <div class="row">\n            <div class="col">\n                <p class="font-weight-bold mb-0" style="font-size:1rem;">Meeting with ${e.extendedProperties.private.patient_email||"-"}</p>\n                <p class="mb-2">${eventTimeToString(e.start.dateTime,e.end.dateTime)}</p>\n            </div>\n            <div class="col-auto">\n                <p class="mb-1"><strong>File No. </strong> ${e.extendedProperties.private.file_no}</p>\n            </div>\n        </div>\n        <p class="mb-1"><strong>Chief Complaint: </strong> ${e.extendedProperties.private.chief_complaint||"-"}</p>\n        <p class="mb-1"><strong>Location: </strong> ${e.location||"-"}</p>\n        <p class="mb-1"><strong>Service Details: </strong> ${serviceDetails(e.extendedProperties.private)} \n        </p>`,e.organizer.email==e.extendedProperties.private.doctor_email?htmlContent+=`<p class="mb-0"><strong>Doctor: </strong>${e.organizer.displayName||e.organizer.email}</p>`:htmlContent+=`<p class="mb-0"><strong>Doctor: </strong>${e.organizer.email}</p>\n                    <p class="mb-1">Created By ${e.organizer.displayName||e.organizer.email}</p>`,htmlContent+=`<div class="row">\n                    <div class="col">\n                        <p class="mb-1"><strong>Status: </strong>${e.extendedProperties.private.event_status}</p>`,"Paid"===e.extendedProperties.private.payment_status&&(htmlContent+=`    <p class="mb-1"><strong>Amount Paid: </strong> ${e.extendedProperties.private.amount||e.extendedProperties.private.service_amount} </p>`),null!=e.extendedProperties.private.meeting_link&&(htmlContent+=`<p class="mb-1"><strong>Meeting: </strong><a href="${e.extendedProperties.private.meeting_link}" target="_blank" >Start Meeting</a></p>`),htmlContent+="</div>",htmlContent+='  <div class="col">',null==e.extendedProperties.private.amount&&"paid"!==e.extendedProperties.private.payment_status.toLowerCase()||(htmlContent+=`    <p class="mb-1"><strong>Payment Type: </strong> ${e.extendedProperties.private.payment_type||"Credit Card"} </p>`),null!=e.extendedProperties.private.payment_ref&&"paid"===e.extendedProperties.private.payment_status.toLowerCase()&&(htmlContent+=`    <p class="mb-1"><strong>Payment Ref: </strong> ${e.extendedProperties.private.payment_ref} </p>`),htmlContent+="   </div>",htmlContent+="</div>","Reschedule"==e.extendedProperties.private.event_status&&(htmlContent+=`<button class="btn btn-outline-primary action btn-sm m-1" type="button" data-action="confirm" data-id='${e.id}'>CONFIRM</button>`),"paid"!=e.extendedProperties.private.payment_status.toLowerCase()&&(htmlContent+=`<button class="btn btn-outline-primary action btn-sm m-1" type="button" data-action="pay-now" data-eid='${e.id}' data-doc-mail="${e.extendedProperties.private.cal_id}">PAY NOW</button>`,htmlContent+=`<button class="btn btn-outline-primary action btn-sm m-1" type="button" data-action="reschedule" data-id='${e.id}'>RESCHEDULE</button>`),htmlContent+="</div>\n        </div>","pending"==e.extendedProperties.private.payment_status.toLowerCase()&&e.extendedProperties.private.hasOwnProperty("payment_ref"),htmlContent}function renderInvoice(e){return'<footer class="sticky-footer w-100 text-center">\n                      <p class="mb-0 font-weight-bold">Araa Consultancy and Studies</p>\n                      <p class="mb-0">Unit 201, DBCS Building Al Gar houd 13866 Dubai 941, Tel: +971 ---------------</p>\n                      <p class="mb-0">Email: ahmedalnajjar@ahmedalnajjar.com web: www.ahmedalnajjar.com</p>\n                  </footer>','<div class="row">\n                      <div class="col-12 text-center"><img src="./assets/img/araa-consultancy-and-studies-logo.png" />\n                          <p class="mb-0">Experience Most Compassionate Healthcare in UAE</p>\n                          <p class="mb-0">Under the</p>\n                          <p class="font-weight-bold mb-5">Leadership of Dr. Ahmed Alnajjar</p>\n                      </div>\n                      <div class="col-12">\n                          <div class="row mb-5">\n                              <div class="col">\n                                  <p>Name: Mohammed Salman</p>\n                                  <p>Email : mohammedsalman0258@gmail.com</p>\n                                  <p>Age: 41 Years</p>\n                                  <p>Appointment : 30/1/2021 03:00 PM - 3:30 PM</p>\n                                  <p>Chief Complaint : Depression</p>\n                              </div>\n                              <div class="col-auto">\n                                  <p>File No. 168254858774</p>\n                                  <p>Doctor: Dr. Ahmed Alnajjar</p>\n                              </div>\n                          </div>\n                          <div class="table-responsive">\n                              <table class="table">\n                                  <thead>\n                                      <tr>\n                                          <th>Description</th>\n                                          <th>Price</th>\n                                      </tr>\n                                  </thead>\n                                  <tbody>\n                                      <tr>\n                                          <td>Video Call</td>\n                                          <td>500 AED</td>\n                                      </tr>\n                                  </tbody>\n                                  <tfoot>\n                                      <tr>\n                                          <td>Total</td>\n                                          <td>500 AED</td>\n                                      </tr>\n                                  </tfoot>\n                              </table>\n                          </div>\n                      </div>\n                    </div><footer class="sticky-footer w-100 text-center">\n                      <p class="mb-0 font-weight-bold">Araa Consultancy and Studies</p>\n                      <p class="mb-0">Unit 201, DBCS Building Al Gar houd 13866 Dubai 941, Tel: +971 ---------------</p>\n                      <p class="mb-0">Email: ahmedalnajjar@ahmedalnajjar.com web: www.ahmedalnajjar.com</p>\n                  </footer>'}function getResponse(e,t,n){showSpinner(),$.ajax({url:""+ENDPOINT+e,type:"get",dataType:"json",data:t,contentType:"application/json"}).done((function(e){n(e)})).fail((function(e){dangerToast("Error Connecting to Server"),console.log("error -",e)})).always((function(e){hideSpinner()}))}function getSyncResponse(e,t){showSpinner(),$.ajax({url:""+ENDPOINT+e,type:"get",dataType:"json",data:t,async:!1,contentType:"application/json"}).done((function(e){return e})).fail((function(e){return console.log("error -",e),dangerToast("Error Connecting to Server"),e})).always((function(e){hideSpinner()}))}function asyncResponse(e,t,n,o){showSpinner(),"post"!=e.toLowerCase()&&"put"!=e.toLowerCase()||(n=JSON.stringify(n)),$.ajax({url:""+ENDPOINT+t,type:e,dataType:"json",data:n,contentType:"application/json",processing:!1}).done(e=>{o(e)}).fail(e=>{console.log("error -",e)}).always(e=>{hideSpinner()})}function showSpinner(){$('<div class="overlay"><div id="spinner"></div></div>').appendTo("body");let e=document.getElementById("spinner");new Spinner({lines:8,length:28,width:10,radius:42,scale:1,corners:1,color:"#FFF",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!0,hwaccel:!1,position:"absolute"}).spin(e)}function hideSpinner(){setTimeout(()=>{$(".overlay").remove()},2e3)}var forms={showForms:function(){$(".sections").addClass("d-none"),$(".sections.view-forms").removeClass("d-none"),forms.listForms()},listForms:function(e){getResponse(`/users/${sessionStorage.getItem("pid")}/forms`,{email:sessionStorage.getItem("pt-email")},e=>{$("#forms-list").html(""),e.Items.forEach(e=>{$(`<li class="p-3 m-2 text-white text-uppercase pointer rounded action" style="background: linear-gradient(120deg,#7f70f5,#0ea0ff);" data-action="view-form" data-form-type='${e.form_type}' data-created="${e.created}">\n                <span class="d-block mb-1 text-uppercase font-weight-bold">${e.form_type.replaceAll("_"," ")}</span>\n                <span>${moment(e.created).format("LLL")}</span>\n              </li>`).appendTo("#forms-list")})})},viewForm:function(e,t){asyncResponse("GET",`/users/${sessionStorage.getItem("pid")}/forms`,{email:sessionStorage.getItem("pt-email"),form_type:e,created:t},t=>{if("adult_form_ar"==e&&($(".forms").addClass("d-none"),$("#forms-data").html(ptRenderForm(t))),"adult_form_ar"!=e){$("#forms-data").html(""),$(".forms").addClass("d-none"),$(".forms."+e).removeClass("d-none");let n=t.Items[0].form_data;js2form(""+e,n),$(".forms."+e).find("input,select,textarea,.custom-control-label").addClass("input-no-edit"),$(".countries-list").val(n.nationality),$(".countries-list").trigger("change"),$(".countries-list").prop("disabled",!0),$(".tel-phone-input").val(n.phone_number),$(".tel-phone-input").trigger("change"),$(".tel-phone-input").prop("disabled",!0),$(".signature-pad-actions").addClass("d-none");let o,a=1;for(o in n)o.includes("signature")?$(`#signature-pad-${a} canvas`).replaceWith(`<img class="img-fluid eidb" src="${n[o]}"/>`):$("canvas").remove()}})}};if(null!=document.getElementById("signature-pad-1")){var wrapper=document.getElementById("signature-pad-1"),clearButton=wrapper.querySelector("[data-action=clear]"),undoButton=wrapper.querySelector("[data-action=undo]"),lockButton=wrapper.querySelector("[data-action=lock]"),uploadSignature=wrapper.querySelector("[data-action=upload-signature]"),uploadedFile=wrapper.querySelector("input[type=file]"),signatureinputField=wrapper.querySelector("input[type=text]"),canvas=wrapper.querySelector("canvas"),signaturePad=new SignaturePad(canvas,{backgroundColor:"rgb(255, 255, 255)",penColor:"rgb(0, 0, 0)",velocityFilterWeight:.7,minWidth:.5,maxWidth:2.5,throttle:16,minPointDistance:3,onEnd:function(){wrapper.querySelector("input[type=text]").value=signaturePad.toDataURL(),console.log("sign 1 data - ",wrapper.querySelector("input[type=text]").value)}});function resizeCanvas(){var e=Math.max(window.devicePixelRatio||1,1);canvas.width=canvas.offsetWidth*e,canvas.height=canvas.offsetHeight*e,canvas.getContext("2d").scale(e,e);var t=signaturePad.toData();signaturePad.fromData(t)}function checkLock(){return status=lockButton.childNodes[0].className,"fa fa-lock"===status}window.onresize=resizeCanvas,resizeCanvas(),lockButton.addEventListener("click",(function(e){"fa fa-unlock-alt"==this.childNodes[0].className?(this.childNodes[0].className="fa fa-lock",signaturePad.off()):(this.childNodes[0].className="fa fa-unlock-alt",signaturePad.on())})),clearButton.addEventListener("click",(function(e){checkLock()||signaturePad.clear()})),undoButton.addEventListener("click",(function(e){var t=signaturePad.toData();checkLock()||t&&(t.pop(),signaturePad.fromData(t))})),uploadSignature.addEventListener("click",(function(e){wrapper.querySelector("input[type=file]").trigger("click")})),uploadedFile.addEventListener("change",(function(e){}))}if(null!=document.getElementById("signature-pad-2")){var wrapper2=document.getElementById("signature-pad-2"),clearButton2=wrapper2.querySelector("[data-action=clear]"),undoButton2=wrapper2.querySelector("[data-action=undo]"),lockButton2=wrapper2.querySelector("[data-action=lock]"),uploadSignature2=wrapper2.querySelector("[data-action=upload-signature]"),uploadedFile2=wrapper2.querySelector("input[type=file]"),signatureinputField2=wrapper2.querySelector("input[type=text]"),canvas2=wrapper2.querySelector("canvas"),signaturePad2=new SignaturePad(canvas2,{backgroundColor:"rgb(255, 255, 255)",backgroundColor:"rgb(255, 255, 255)",penColor:"rgb(0, 0, 0)",velocityFilterWeight:.7,minWidth:.5,maxWidth:2.5,throttle:16,minPointDistance:3,onEnd:function(){wrapper2.querySelector("input[type=text]").value=signaturePad2.toDataURL(),console.log("sign 2 data - ",wrapper2.querySelector("input[type=text]").value)}});function resizeCanvas2(){var e=Math.max(window.devicePixelRatio||1,1);canvas2.width=canvas2.offsetWidth*e,canvas2.height=canvas2.offsetHeight*e,canvas2.getContext("2d").scale(e,e);var t=signaturePad2.toData();signaturePad2.fromData(t)}function checkLock2(){return"fa fa-lock"===lockButton2.childNodes[0].className}window.onresize=resizeCanvas2,resizeCanvas2(),lockButton2.addEventListener("click",(function(e){"fa fa-unlock-alt"==this.childNodes[0].className?(this.childNodes[0].className="fa fa-lock",signaturePad2.off()):(this.childNodes[0].className="fa fa-unlock-alt",signaturePad2.on())})),clearButton2.addEventListener("click",(function(e){checkLock2()||signaturePad2.clear()})),undoButton2.addEventListener("click",(function(e){var t=signaturePad2.toData();checkLock2()||t&&(t.pop(),signaturePad2.fromData(t))}))}function dataURLToBlob(e){for(var t=e.split(";base64,"),n=t[0].split(":")[1],o=window.atob(t[1]),a=o.length,i=new Uint8Array(a),r=0;r<a;++r)i[r]=o.charCodeAt(r);return new Blob([i],{type:n})}function download(e,t){if(navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome"))window.open(e);else{var n=dataURLToBlob(e),o=window.URL.createObjectURL(n),a=document.createElement("a");a.style="display: none",a.href=o,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(o)}}function printForm(e){$(".page-header");let t=$(`iframe[name="${e}"`).contents().find(".page-header").height(),n=$(`iframe[name="${e}"`).contents().find(".page-footer").height();void 0===t&&(t=0),void 0===n&&(n=0),t+=10,n+=10,$(`iframe[name="${e}"`).contents().find(".style").text(`@media print {.page-header-space { height: ${t}px!important;} .page-footer-space {height: ${n}px!important;}}`),window.frames[e].print()}function resizeHeaderFooter(){let e=$("header").height(),t=$("footer").height();void 0===e&&(e=0),void 0===t&&(t=0),e+=10,t+=10,$(".style").text(`@media print {.page-header-space { height: ${e}px!important;} .page-footer-space {height: ${t}px!important;}}`)}resizeHeaderFooter();